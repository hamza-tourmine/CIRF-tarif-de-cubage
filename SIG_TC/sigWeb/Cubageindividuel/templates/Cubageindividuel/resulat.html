{% extends 'base.html' %}
{% load static %}
{% load crispy_forms_tags %}

{% block contenu %}
<div class="main1 p-3">
    <div style="text-align: right; margin-top: 20px;">
        <button class="btn btn-outline-danger" id="btn-print"><i class="fa-solid fa-print"></i></button>
    </div>
    <br>
    <div class="container-fluid" >
        <div class="titre"><h2>Resultat de calcul</h2> </div>
    </div>
    <div class="container-fluid" id="content">
        <br>
        <h2 style="text-align: center;">VOLUME BOIS INDIVIDUEL</h2>
        <br>
        <div class="row">
            <div class="col">
                <table style="width: 100%; border-collapse: collapse; border: 1px solid black;">
                    <thead>
                        <tr>
                            <th style="border: 1px solid black; padding: 8px;">Forêt</th>
                            <th style="border: 1px solid black; padding: 8px;">Canton</th>
                            <th style="border: 1px solid black; padding: 8px;">Essence</th>
                            <th style="border: 1px solid black; padding: 8px;">Régime</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td style="border: 1px solid black; padding: 8px;">{{ Foret }}</td>
                            <td style="border: 1px solid black; padding: 8px;">{{ canton_name }}</td>
                            <td style="border: 1px solid black; padding: 8px;">{{ essence }}</td>
                            <td style="border: 1px solid black; padding: 8px;">{{ regime }}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <br>

        <!-- Class Information Table -->
        <h3>Informations au niveau de chaque classe</h3>
        <div class="row">
            <div class="col">
                <table style="width: 100%; border-collapse: collapse; border: 1px solid black;">
                    <thead>
                        <tr>
                            <th style="border: 1px solid black; padding: 8px;">Circonférence à 1m30</th>
                            <th style="border: 1px solid black; padding: 8px;">Nombre total bois</th>
                            <th style="border: 1px solid black; padding: 8px;">Volume total (m³)</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for bois in liste_de_bois %}
                            {% if bois.nombre_de_bois_classe > 0 %}
                                <tr>
                                    <td style="border: 1px solid black; padding: 8px;">{{ bois.circonferance_1m30 }}</td>
                                    <td style="border: 1px solid black; padding: 8px;">{{ bois.nombre_de_bois_classe }}</td>
                                    <td style="border: 1px solid black; padding: 8px;">{{ bois.volume_total_classe }}</td>
                                </tr>
                            {% endif %}
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
        <br>

        <!-- Yield Information Table -->
        <h3>Volume total des bois dans la liste</h3>
        <h6>Parcelle: <b>{{ Strate.parcelle }}</b> Groupe: <b>{{ Strate.groupe }}</b></h6>
        <div class="row">
            <div class="col">
                <table style="width: 100%; border-collapse: collapse; border: 1px solid black;">
                    <thead>
                        <tr>
                            <th style="border: 1px solid black; padding: 8px;">Essence</th>
                            <th style="border: 1px solid black; padding: 8px;">Tarif de cubage</th>
                            <th style="border: 1px solid black; padding: 8px;">Intervalle d'application du modèle</th>
                            <th style="border: 1px solid black; padding: 8px;">Nombre total de bois</th>
                            <th style="border: 1px solid black; padding: 8px;">Volume total des bois dans la liste (m³)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td style="border: 1px solid black; padding: 8px;">{{ essence }}</td>
                            <td style="border: 1px solid black; padding: 8px;">{{ FormuleTarif }}</td>
                            <td style="border: 1px solid black; padding: 8px;">{{ intervalle_validite }}</td>
                            <td style="border: 1px solid black; padding: 8px;">{{ placette.nombre_de_bois_total }}</td>
                            <td style="border: 1px solid black; padding: 8px;">{{ placette.volume_total }}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <br>
</div>

{% block javascript %}
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    jQuery(document).ready(function () {
        $('#btn-print').click(function () {
            var content = $('#content').html();
            var printWindow = window.open('', '', 'height=800,width=800');
            printWindow.document.write('<html><head><title>Resulat de calcul/GIS-TARIF CUBAGE </title>');
            printWindow.document.write('<link rel="stylesheet" href="{% static "css/styleglobal.css" %}" type="text/css" />');
            printWindow.document.write('<link rel="stylesheet" href="{% static "Rendementliege/css/style.css" %}" type="text/css" />'); // Inclure votre fichier CSS si nécessaire
            printWindow.document.write('</head><body>');
            printWindow.document.write(content);
            printWindow.document.write('</body></html>');
            printWindow.document.close();

            // Attendre que la fenêtre ait fini de charger le contenu avant d'imprimer
            printWindow.onload = function() {
                printWindow.print();
            };
        });
    });
</script>
{% endblock %}
{% endblock %}
